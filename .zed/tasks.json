// Project tasks configuration. See https://zed.dev/docs/tasks for documentation.
//
[
  {
    "label": "grep",
    "command": "grep -rne \"$ZED_SELECTED_TEXT\" *|grep zig:",
    "cwd": "$ZED_WORKTREE_ROOT/zig/zag",
  },
  {
    "label": "test-current",
    "command": "zig test -freference-trace=20 $ZED_FILENAME",
    "cwd": "$ZED_WORKTREE_ROOT/$ZED_RELATIVE_DIR",
    "hide": "on_success",
  },
  {
    "label": "test-default",
    "command": "zig build test -freference-trace=20",
    "cwd": "$ZED_WORKTREE_ROOT/zig/zag",
    //"hide": "on_success",
  },
  {
    "label": "test-llvm",
    "command": "zig build test -freference-trace=20 -Dllvm",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
    "hide": "on_success",
  },
  {
    "label": "test fib",
    "command": "zig build -Doptimize=Debug -freference-trace=5 && ./zig-out/bin/fib",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "trace fib",
    "command": "zig build -Dtrace -Doptimize=Debug -freference-trace=5 && ./zig-out/bin/fib",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "trace fib NaN",
    "command": "zig build -Dtrace -Dencoding=nan -Doptimize=Debug -freference-trace=5 && ./zig-out/bin/fib",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "time fib",
    "command": "zig build -Doptimize=ReleaseFast && ./zig-out/bin/fib",
    //"command": "zig build -Doptimize=ReleaseFast && taskpolicy -l5 -t5 time ./zig-out/bin/fib",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "time fib NaN",
    "command": "zig build -Dencoding=nan -Doptimize=ReleaseFast && ./zig-out/bin/fib",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "branchPrediction",
    "command": "zig build-exe -O ReleaseFast branchPrediction.zig && taskpolicy -l5 -t5 time ./branchPrediction",
    "cwd": "$ZED_WORKTREE_ROOT/zig",
  },
  {
    "label": "sacTest",
    "command": "cc -o sacTest sacTest.c halfsiphash.c && ./sacTest",
    "cwd": "$ZED_WORKTREE_ROOT/c",
  },
]
